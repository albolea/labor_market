str(base)
plot_missing(base)
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot() + coord_flip()
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip()
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
str(base)
summary(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(y = WAGP)) + geom_boxplot() + coord_flip()
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot() + ylab = "Wage" + coord_flip()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot() + ylab = ("Wage") + coord_flip()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot() + ylab = ("Wage") + coord_flip()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip()
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + xlab("Wage")
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + ylab("Wage")
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("Race") + ylab("Wage")
base  %>% ggplot(aes(WAGP)) + geom_density()
base  %>% ggplot(aes(WAGP)) + geom_density()
base  %>% ggplot(aes(y=WAGP)) + geom_boxplot()
View(base)
base  %>% ggplot(aes(x = WAGP)) + geom_density()
ggplot(data = base, aes(x = AGEP)) + geom_density()
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density")
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density")
ggplot(data = base, aes(x = RAC1P)) + geom_line(stat = "density", colour = RAC1P)
ggplot(data = base, aes(x = RAC1P, fill = RAC1P)) + geom_density()
ggplot(data = base, aes(x = RAC1P, fill = RAC1P)) + geom_density(alpha = .3)
ggplot(data = base, aes(x = RAC1P, fill = RAC1P)) + geom_density(alpha = .3) + coord_flip()
ggplot(data = base, aes(x = RAC1P, fill = RAC1P)) + geom_density(alpha = .3)
ggplot(data = base, aes(x = RAC1P, fill = RAC1P)) + geom_density(alpha = .3) + coord_flip()
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .3) + coord_flip()
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .3)
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .1)
ggplot(data = base, aes(x = RAC1P, y = WAGP, fill = RAC1P)) + geom_point()
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2)
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density")
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + ylab("Wage") + ggtitle("Wage") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + ylab("Wage") + ggtitle("Wage - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("Race") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density")
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar()
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("Access to Internet") + ylab("Counts") + coord_flip()
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Sum of ")
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet")
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = ACCESS, RAC1P)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = ACCESS, fill = RAC1P)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS"))
View(base2)
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(c("RAC1P","ACCESS")) %>%
count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(c("RAC1P","ACCESS")) %>%
mutate = count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by("RAC1P","ACCESS") %>%
mutate = count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P,ACCESS) %>%
mutate = count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P) %>%
mutate = count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
mutate = count()
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
mutate(n())
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
mutate(access_counts = n_distinct())
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
mutate(access_counts = n_distinct(RAC1P))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(access_counts = count())
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS)
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(dis = n_distinct(RAC1P, ACCESS), counts = n())
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(n_distinct(RAC1P, ACCESS), counts = n())
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_bar()
ggplot(data = base2, aes(x = ACCESS, y = counts) + geom_bar()
ggplot(data = base2, aes(x = ACCESS, y = counts)) + geom_bar()
ggplot(data = base2, aes(x = ACCESS, RAC1P, y = counts)) + geom_bar()
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge")
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip()
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + guides(fill = FALSE)
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other_Groups",
AGEP >= 14 & AGEP <= 62 ~ "Age_14_to_62",
AGEP > 62 ~ "Other_Groups"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base$WKW <- NULL
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + ylab("Wage") + ggtitle("Wage - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("Race") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
base$WKW <- NULL
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base2 <- base %>%  filter(WAGP<54000 & WAGP > 16000)
summary(base2)
summary(base2$WAGP)
summary(base2$WAGP)
ggplot(data = base2, aes(WAGP)) + geom_density()
base2 <- base %>%  filter(WAGP<54000 & WAGP > 6000)
summary(base2$WAGP)
ggplot(data = base2, aes(WAGP)) + geom_density()
base2 <- base %>%  filter(WAGP<54000 & WAGP > 1000)
summary(base2$WAGP)
ggplot(data = base2, aes(WAGP)) + geom_density()
base2 <- base %>%  filter(WAGP<54000 & WAGP > 0)
summary(base2$WAGP)
ggplot(data = base2, aes(WAGP)) + geom_density()
base2 <- base %>%  filter(WAGP<54000 & WAGP > 11600)
summary(base2$WAGP)
ggplot(data = base2, aes(WAGP)) + geom_density()
rm("base2")
summary(base)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
levels(base$WAOB) <- convertCSV2Factor("WAOB")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
ggplot(data = base, aes(y = WAGP)) + geom_boxplot()  + coord_flip() + ylab("Wage") + ggtitle("Wage - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("Race") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
base$WKW <- NULL
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base <- base %>%  filter(WAGP<54000 & WAGP > 11600)
summary(base)
