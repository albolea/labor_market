base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS),
NATIVITY = as.factor(NATIVITY)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
levels(base$WAOB) <- convertCSV2Factor("WAOB")
levels(base$NATIVITY) <- convertCSV2Factor("NATIVITY")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
base %>% ggplot(aes(WAGP)) + geom_histogram(binwidth = 10000, fill = "white", colour = "black") + xlab("Wage") + ylab("Counts") + ggtitle("Wage Dispersion") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("Race") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
View(base2)
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P,) %>%
summarise(counts = n())
View(base3)
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P) %>%
summarise(counts = n())
base2 <- base2 %>% left_join(base3)
View(base2)
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P) %>%
summarise(counts = n())
base4 <- merge(x = base2, y = base3, by = "RAC1P", all.x = TRUE)
View(base4)
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P) %>%
summarise(counts = n())
base4 <- merge(x = base2, y = base3, by = "RAC1P", all.x = TRUE)
base4 <- base4 %>%
mutate(rate = base4$counts.x/base4$counts.y)
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm(c("base3","base4"))
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm(c(base3,base4))
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base3","base4")
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base2")
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base <- base %>%  filter(WAGP<54000 & WAGP > 11600)
base <- base %>%  filter(WAGP<54000 & WAGP > 11600)
missing(base)
plot_missing(base)
plot_missing(base)
summary(base)
View(base)
base2 <- base %>%
filter(WKW in c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months"))
base2 <- base %>%
filter(WKW %in% c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months"))
View(base2)
base2 <- base %>%
filter(WKW %in% c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months", "40 to 47 weeks worked during past 12 months"))
base <- base %>%
filter(WKW %in% c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months", "40 to 47 weeks worked during past 12 months"))
rm("base2")
summary(base)
View(base)
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
base_model <- base %>%
filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
mutate(free_access = ACCESS == "Free Access",
hispanic = HISP != "Not Spanish/Hispanic/Latino",
black = RACBLK == "Yes"
)
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS),
NATIVITY = as.factor(NATIVITY)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
levels(base$WAOB) <- convertCSV2Factor("WAOB")
levels(base$NATIVITY) <- convertCSV2Factor("NATIVITY")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS),
NATIVITY = as.factor(NATIVITY)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
levels(base$WAOB) <- convertCSV2Factor("WAOB")
levels(base$NATIVITY) <- convertCSV2Factor("NATIVITY")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
base %>% ggplot(aes(WAGP)) + geom_histogram(binwidth = 10000, fill = "white", colour = "black") + xlab("Wage") + ylab("Counts") + ggtitle("Wage Dispersion") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P) %>%
summarise(counts = n())
base4 <- merge(x = base2, y = base3, by = "RAC1P", all.x = TRUE)
base4 <- base4 %>%
mutate(rate = base4$counts.x/base4$counts.y)
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base3","base4", "base2")
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base <- base %>%  filter(WAGP<54000 & WAGP > 11600)
plot_missing(base)
base <- base %>%
filter(WKW %in% c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months", "40 to 47 weeks worked during past 12 months"))
summary(base)
base %>% select(ACCESS) %>% summary()
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot(aes(WAGP,color=ACCESS)) + geom_density() +
labs(title="Earnings x Access to the internet",
x ="Earnings", y = "Density") +
scale_color_discrete(name="Internet Access",
labels=c("Free Access", "No Access"))
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot() + geom_histogram(aes(x=WAGP,fill=ACCESS), binwidth = 10000)
base %>%
filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
group_by(ACCESS, RAC1P) %>%
summarise (mean(WAGP),sd(WAGP),min(WAGP),max(WAGP), median(WAGP))
base %>% select(RAC1P) %>% summary()
base %>% filter(ACCESS=="No Access") %>% select(RAC1P) %>% summary() #person doesn't have ACCESS to Internet
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot() + geom_bar(aes(x = RAC1P, fill=ACCESS)) +
coord_flip() +
xlab('Race') +
scale_x_discrete(labels = c('White', 'Black', 'Native American', "Multiple tribes", "Asian", 'Pacific Islander', 'Other', 'Two or more Races')) +
theme(legend.position= c(0.87,0.85))
base_model <- base %>%
filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
mutate(free_access = ACCESS == "Free Access",
hispanic = HISP != "Not Spanish/Hispanic/Latino",
black = RACBLK == "Yes"
)
model_01 <- lm(WAGP ~ free_access, data = base_model)
model_01 %>% summary()
model_02 <- lm(WAGP ~ free_access + hispanic + black, data = base_model)
model_02 %>% summary()
# Clear environment
rm(list = ls(all = TRUE))
# check if package is installed, if not installed then load
if(!require(here)){
install.packages("here")
}
library(here)
if(!require(tidyverse)){
install.packages("tidyverse")
}
library(tidyverse)
if(!require(DataExplorer)){
install.packages("DataExplorer")
}
library(DataExplorer)
source(here("code","function_convert_CSV_to_vector.R"))
#load the persional data to variable Base
base <- read_csv(here('raw_data','ss16pal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
AGEP,  # Age: 0#99
SEMP,  # Self-employment income past 12 months (signed)
WAGP,  # Wages or salary income past 12 months
HISP,  # Recoded detailed Hispanic origin
NATIVITY,  # Nativity
PERNP, # Total person's earnings
RAC1P, # Recoded detailed race code
RACAIAN, # American Indian and Alaska Native recode
RACASN,  # Asian recode
RACBLK,  # Black or African American recode
RACNH, # Native Hawaiian recode
RACWHT,  # White recode
WAOB,  # World area of birth
WKW)   #Weeks worked during past 12 months
#Link the house hould data
househould <- read_csv(here('raw_data','ss16hal.csv'))%>%
select(SERIALNO, #Serial Number to link House Hold and Personal data
ACCESS # Access to the Internet
)
base <- base %>% left_join(househould) %>% select(-SERIALNO)
rm(househould)
str(base)
#conver the catagorical variable type
base <- base %>% mutate(HISP= as.factor(HISP),
RAC1P= as.factor(RAC1P),
RACAIAN = as.factor(RACAIAN),
RACASN = as.factor(RACASN),
RACBLK = as.factor(RACBLK),
RACNH = as.factor(RACNH),
RACWHT = as.factor(RACWHT),
WAOB = as.factor(WAOB),
WKW = as.factor(WKW),
ACCESS = as.factor(ACCESS),
NATIVITY = as.factor(NATIVITY)
)
#conver the numeric variable type
base <- base %>% mutate(AGEP = as.numeric(AGEP),
SEMP= as.numeric(SEMP),
WAGP= as.numeric(WAGP),
PERNP= as.numeric(PERNP)
)
levels(base$ACCESS) <- convertCSV2Factor("ACCESS")
levels(base$HISP) <- convertCSV2Factor("HISP")
levels(base$RAC1P) <- convertCSV2Factor("RAC1P")
levels(base$RACAIAN) <- convertCSV2Factor("RACAIAN")
levels(base$RACASN) <- convertCSV2Factor("RACASN")
levels(base$RACBLK) <- convertCSV2Factor("RACBLK")
levels(base$RACNH) <- convertCSV2Factor("RACNH")
levels(base$RACWHT) <- convertCSV2Factor("RACWHT")
levels(base$WKW) <- convertCSV2Factor("WKW")
levels(base$WAOB) <- convertCSV2Factor("WAOB")
levels(base$NATIVITY) <- convertCSV2Factor("NATIVITY")
str(base)
summary(base)
plot_missing(base)
base %>% select(AGEP) %>%  summary()
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion") + theme(plot.title = element_text(hjust = 0.5))
summary(base$WAGP)
base %>% ggplot(aes(WAGP)) + geom_histogram(binwidth = 10000, fill = "white", colour = "black") + xlab("Wage") + ylab("Counts") + ggtitle("Wage Dispersion") + theme(plot.title = element_text(hjust = 0.5))
base  %>% ggplot(aes(x = WAGP)) + geom_density() + xlab("Wage") +ylab("Density") + ggtitle("Wage - Density") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = RAC1P, y = WAGP)) + geom_boxplot() + coord_flip() + xlab("") + ylab("Wage") + ggtitle("Wage by Races - Box Plot") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data = base, aes(x = WAGP, fill = RAC1P)) + geom_density(alpha = .2) + xlab("Wage") + ylab("Density") + ggtitle("Wage by Races - Density") + theme(plot.title = element_text(hjust = 0.5))
summary(base$ACCESS)
ggplot(data = base, aes(x = ACCESS)) + geom_bar() + xlab("") + ylab("Sum of Access to Internet") + coord_flip() + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5))
base2 <- base %>%
select(c("RAC1P","ACCESS")) %>%
group_by(RAC1P, ACCESS) %>%
summarise(counts = n())
ggplot(data = base2, aes(x = ACCESS, y = counts, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
base3 <- base %>%
select(c("RAC1P")) %>%
group_by(RAC1P) %>%
summarise(counts = n())
base4 <- merge(x = base2, y = base3, by = "RAC1P", all.x = TRUE)
base4 <- base4 %>%
mutate(rate = base4$counts.x/base4$counts.y)
ggplot(data = base4, aes(x = ACCESS, y = rate, fill = RAC1P)) + geom_col(position = "dodge") + coord_flip() + xlab("") + ylab("Sum of Access to Internet")  + ggtitle("Summary of Access to Internet") + theme(plot.title = element_text(hjust = 0.5)) + labs(fill = "Race")
rm("base3","base4", "base2")
base <- base %>%
mutate( age_group = case_when(
AGEP < 14 ~ "Other ages (exclude)",
AGEP >= 14 & AGEP <= 62 ~ "Age 14-62 (include)",
AGEP > 62 ~ "Other ages (exclude)"
))
base$age_group <- as.factor(base$age_group)
base %>% ggplot(aes(AGEP)) + geom_histogram(binwidth = 3, fill = "white", colour = "black") + xlab("Age") + ylab("Counts") + ggtitle("Age Dispersion\n This study focuses on the group in the age between 14 to 62") + theme(plot.title = element_text(hjust = 0.5)) + facet_grid(age_group ~ .)
base <- base %>%  filter(AGEP>=14 & AGEP <= 62)
base$age_group <- NULL
base <- base %>%  filter(WAGP<54000 & WAGP > 11600)
plot_missing(base)
base <- base %>%
filter(WKW %in% c("50 to 52 weeks worked during past 12 months", "48 to 49 weeks worked during past 12 months", "40 to 47 weeks worked during past 12 months"))
summary(base)
base %>% select(ACCESS) %>% summary()
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot(aes(WAGP,color=ACCESS)) + geom_density() +
labs(title="Earnings x Access to the internet",
x ="Earnings", y = "Density") +
scale_color_discrete(name="Internet Access",
labels=c("Free Access", "No Access"))
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot() + geom_histogram(aes(x=WAGP,fill=ACCESS), binwidth = 10000)
base %>%
filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
group_by(ACCESS, RAC1P) %>%
summarise (mean(WAGP),sd(WAGP),min(WAGP),max(WAGP), median(WAGP))
base %>% select(RAC1P) %>% summary()
base %>% filter(ACCESS=="No Access") %>% select(RAC1P) %>% summary() #person doesn't have ACCESS to Internet
base %>%  filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
ggplot() + geom_bar(aes(x = RAC1P, fill=ACCESS)) +
coord_flip() +
xlab('Race') +
scale_x_discrete(labels = c('White', 'Black', 'Native American', "Multiple tribes", "Asian", 'Pacific Islander', 'Other', 'Two or more Races')) +
theme(legend.position= c(0.87,0.85))
base_model <- base %>%
filter(!is.na(ACCESS) & ACCESS != "Paid Access") %>%
mutate(free_access = ACCESS == "Free Access",
hispanic = HISP != "Not Spanish/Hispanic/Latino",
black = RACBLK == "Yes"
)
model_01 <- lm(WAGP ~ free_access, data = base_model)
model_01 %>% summary()
model_02 <- lm(WAGP ~ free_access + hispanic + black, data = base_model)
model_02 %>% summary()
